<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Limpar posts antigos</title>
</head>
<body>
<h2>Apagando posts antigos...</h2>
<script>
const JSONBIN_URL = 'https://api.jsonbin.io/v3/b/68cb524f43b1c97be9469a7a';
const JSONBIN_KEY = '$2a$10$tRSl.w9zvPSnAMtnGO8gVO1fZMmlHtZ8r7QKVDY.zyfu0p25IzUnC';

(async () => {
    try {
        const res = await fetch(JSONBIN_URL, { headers: { 'X-Master-Key': JSONBIN_KEY } });
        const data = await res.json();
        let posts = data.record || [];

        // Remove todos os posts que não têm ownerId (posts antigos)
        posts = posts.filter(post => post.ownerId);

        await fetch(JSONBIN_URL, {
            method: 'PUT',
            headers: { 'Content-Type': 'application/json', 'X-Master-Key': JSONBIN_KEY },
            body: JSON.stringify(posts)
        });

        alert("Todos os posts antigos foram apagados!");
    } catch (e) {
        alert("Erro ao apagar posts: " + e.message);
    }
})();
</script>
</body>
</html>